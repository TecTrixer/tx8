#include <tx8/core/cpu.h>
#include <tx8/core/instruction.h>
#include <tx8/core/types.h>

#include <stdio.h>
#include <stdlib.h>

#define TEST_ROM_SIZE 128

// static const tx_uint8 testrom[TEST_ROM_SIZE] = {tx_op_lda, tx_param_constant8 << 4U, 0x42, tx_op_hlt};
static const tx_uint8 testrom[TEST_ROM_SIZE] = {
    0x00, 0x10, 0x61, 0x00, 0x42, 0x10, 0x62, 0x00, 0x42, 0x00, 0x10, 0x63,
  0x00, 0x42, 0x00, 0x00, 0x00, 0x20, 0x60, 0x00, 0x10, 0x63, 0x04, 0xa2,
  0x15, 0x00, 0x00, 0x03, 0x66, 0x30, 0x04, 0x00, 0x32, 0x01, 0x00, 0x00,
  0x20, 0x50, 0x13, 0x05, 0x00, 0x21, 0x40, 0x31, 0x55, 0x00, 0x22, 0x63,
  0x00, 0xa9, 0x01, 0x00, 0x00, 0x39, 0x64, 0x50, 0x01, 0x41, 0x55, 0x00,
  0xed, 0xfa, 0xff, 0x01, 0x30, 0x00, 0x00, 0x00, 0x00, 0x0a, 0x30, 0xef,
  0xbe, 0xad, 0xde, 0x10, 0x63, 0x02, 0xd6, 0x9c, 0x78, 0x41, 0x30, 0x70,
  0x02, 0x0b, 0x01, 0x30, 0x00, 0x00, 0x00, 0x00, 0x01, 0x30, 0x00, 0x00,
  0x00, 0x00, 0x01, 0x30, 0x9e, 0x00, 0x00, 0x00, 0x01, 0x30, 0x32, 0x01,
  0x00, 0x00
};

int main() {
    tx_CPU cpu;
    tx_init_cpu(&cpu, (tx_mem_ptr)testrom, TEST_ROM_SIZE);
    tx_run_cpu(&cpu);
    tx_destroy_cpu(&cpu);
}
